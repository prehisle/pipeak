# PiPeak 项目信息文档

## 项目概述

PiPeak 是一个专注于 LaTeX 学习的在线教育平台，提供交互式课程、练习和复习功能，帮助用户掌握 LaTeX 语法和使用方法。该项目采用全栈开发架构，包括前端和后端两个主要部分。

## 技术栈

### 前端
- **框架**: React
- **构建工具**: Vite
- **样式**: Tailwind CSS
- **状态管理**: 自定义 Store
- **路由**: React Router
- **国际化**: i18next
- **LaTeX 渲染**: KaTeX
- **测试**: Playwright

### 后端
- **框架**: Flask (Python)
- **数据库**: MongoDB
- **认证**: JWT, OAuth (Google, GitHub)
- **API**: RESTful

## 项目结构

```
pipeak/
├── backend/                # 后端 Flask 应用
│   ├── app/                # 主应用目录
│   │   ├── admin/          # 管理员相关功能
│   │   ├── models/         # 数据模型
│   │   ├── routes/         # API 路由
│   │   ├── services/       # 业务逻辑服务
│   │   └── utils/          # 工具函数
│   ├── tests/              # 测试目录
│   └── translations/       # 翻译文件
├── frontend/               # 前端 React 应用
│   ├── public/             # 静态资源
│   └── src/                # 源代码
│       ├── components/     # React 组件
│       ├── data/           # 静态数据
│       ├── hooks/          # 自定义 React Hooks
│       ├── i18n/           # 国际化配置
│       ├── pages/          # 页面组件
│       ├── services/       # API 服务
│       ├── stores/         # 状态管理
│       ├── tests/          # 测试文件
│       └── utils/          # 工具函数
└── docs/                   # 项目文档
```

## 核心功能模块

### 1. 用户认证系统
- 支持邮箱/密码注册登录
- OAuth 集成 (Google, GitHub)
- JWT 认证
- 访客模式

### 2. 课程系统
- 结构化课程内容
- 多语言支持 (中文, 英文)
- 进度跟踪

### 3. 练习系统
- LaTeX 练习题
- 实时预览
- 答案验证
- 等价表达式识别

### 4. 复习系统
- 基于遗忘曲线的复习提醒
- 复习统计
- 复习进度跟踪

## 数据模型

### User 模型
- 用户基本信息
- 认证信息
- 学习进度

### Lesson 模型
- 课程内容
- 练习题
- 多语言支持

### Practice 模型
- 练习记录
- 答案验证规则

### Review 模型
- 复习记录
- 复习计划

## API 接口

### 认证接口
- `/api/auth/register` - 用户注册
- `/api/auth/login` - 用户登录
- `/api/auth/oauth` - OAuth 认证

### 课程接口
- `/api/lessons` - 获取课程列表
- `/api/lessons/<id>` - 获取课程详情

### 练习接口
- `/api/practice/submit` - 提交练习答案
- `/api/practice/progress` - 获取练习进度

### 复习接口
- `/api/reviews` - 获取复习列表
- `/api/reviews/submit` - 提交复习答案

## 关键技术实现

### LaTeX 等价表达式处理
项目实现了复杂的 LaTeX 等价表达式处理机制，能够识别多种等价写法，如：
- 命令简写等价 (如 `\ne` 与 `\neq`)
- 括号等价 (如 `(x)` 与 `\left(x\right)`)
- 上下标顺序等价 (如 `x^2_i` 与 `x_i^2`)
- 数学环境等价
- 函数表达式等价

### 多语言支持
- 前端使用 i18next 实现界面多语言
- 后端维护课程内容的多语言版本

### 响应式设计
- 使用 Tailwind CSS 实现响应式界面
- 适配桌面和移动设备

## 已知问题与修复

### LaTeX 等价表达式处理问题
- **问题描述**: 在处理某些 LaTeX 等价表达式时，特别是上下标顺序等价时出现错误
- **根本原因**: 函数调用缺少逗号分隔参数，导致字符串自动连接
- **修复方案**: 修复函数调用中的参数分隔，重构代码提高可维护性

### 代码重构
- 将 `practice.py` 重构为 `practice_refactored.py`，提高代码可读性和可维护性
- 将大型函数拆分为多个小函数，每个函数专注于单一功能
- 添加详细注释和文档字符串

## 部署信息

### 环境要求
- Python 3.8+
- Node.js 14+
- MongoDB 4.4+

### 部署步骤
1. 配置环境变量
2. 安装依赖
3. 构建前端
4. 启动后端服务

### 监控与维护
- 日志记录
- 错误追踪
- 性能监控

## 未来计划

### 功能增强
- 添加更多 LaTeX 课程内容
- 实现社区功能，允许用户分享笔记
- 添加更多练习题类型

### 技术改进
- 优化 LaTeX 等价表达式处理算法
- 提高测试覆盖率
- 实现更好的错误处理机制

## 贡献指南

### 代码规范
- Python: PEP 8
- JavaScript: ESLint 配置
- 提交信息格式

### 开发流程
- 分支管理
- 代码审查
- 测试要求